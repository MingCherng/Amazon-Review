##Mapper & Reducer Coding
#Create a workspace Folder > Move into my workspace > Prepare my Dataset 
mkdir amazonreview 
cd amazonreview 
aws s3 cp s3://glassdoorfinal/train.csv . 

##Create the mapper file
nano mapper.py 

## Mapper.py code in the nano mapper.py screen
#!/usr/bin/env python3 import sys import csv 

positive_words = ['good', 'great', 'excellent', 'amazing', 'love', 'wonderful', 'fantastic', 'best'] negative_words = ['bad', 'poor', 'terrible', 'hate', 'awful', 'worst', 'disappointing', 'horrible'] 

review_column_index = 2 # review_text column 

reader = csv.reader(sys.stdin) 

for row in reader: try: # Skip header if len(row) <= review_column_index or row[review_column_index].strip().lower() == "review_text": continue 

   review = row[review_column_index].lower() 
 
    pos_count = sum(word in review for word in positive_words) 
    neg_count = sum(word in review for word in negative_words) 
 
    if pos_count > neg_count: 
        sentiment = "positive" 
    elif neg_count > pos_count: 
        sentiment = "negative" 
    else: 
        sentiment = "neutral" 
 
    print(f"{sentiment}\t1") 
 
except Exception: 
    continue 


##Create the reducer file
nano reducer.py 

##Reducer.py code in the nano reducer.py screen
#!/usr/bin/env python3 import sys 

current_sentiment = None current_count = 0 

for line in sys.stdin: try: sentiment, count = line.strip().split("\t") count = int(count) except: continue 

if current_sentiment == sentiment: 
    current_count += count 
else: 
    if current_sentiment: 
        print(f"{current_sentiment}\t{current_count}") 
    current_sentiment = sentiment 
    current_count = count 
  

if current_sentiment: print(f"{current_sentiment}\t{current_count}") 

##Local Result test to output the total Sentiment Analysis (Positive/Neutral/Negative) 
cat train.csv | ./mapper.py | ./reducer.py 



















